/* ───────────────────────────────
   NAVBAR STRUCTURE & LAYOUT
   ─────────────────────────────── */
:root {
  --nav-font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
    Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  --nav-size: 14px;
  --nav-height: 56px; /* slightly taller than before */
  --nav-fg: #e5e7eb;
  --nav-fg-dim: #94a3b8;
  --nav-bg: #0b1222;
}

/* Bar container */
.cap-navbar {
  background: #1e293b !important;
  color: var(--nav-fg);
  font-family: var(--nav-font);
  font-size: var(--nav-size);
  min-height: var(--nav-height);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.35);
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);

  /* a little vertical breathing room so the burger is fully contained */
  padding-top: 0.6rem;
  padding-bottom: 0.6rem;
}

/* grid layout: Brand | Status | Controls */
.cap-navbar .cap-navbar-row {
  display: flex;
  grid-template-columns: minmax(220px, 32vw) 1fr auto;
  align-items: center;
  column-gap: 12px;
}

/* When sidebar burger exists */
.has-left-burger .cap-navbar-row {
  /* grid-template-columns: 48px minmax(200px, auto) 1fr auto; */
  margin-left: 1rem;
}

.has-left-burger .Navbar-toggle-btn {
  position: absolute;
  top: 12px;
  left: 12px;
  z-index: 1100;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.06);
  color: #e5e7eb;
  border: 1px solid rgba(255, 255, 255, 0.12);
}

/* Hide sidebar burger on small/mobile screens */
@media (max-width: 991px) {
  .Navbar-toggle-btn {
    display: none;
  }
}

/* Brand area */
.Navbar-brand-container {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}

.Navbar-brand-slot {
  display: inline-block;
  width: clamp(180px, 26vw, 340px);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-weight: 600;
  letter-spacing: 0.3px;
  color: #f1f5f9;
}

/* Status strip */
.navbar-status-bar {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 10px;
  margin-left: auto;
  min-width: 420px;
  max-width: 680px;
  flex-wrap: nowrap;
  font-size: 0.85rem;
  color: #cbd5e1;
}

.status-item {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  white-space: nowrap;
}

.status-item .label {
  color: #94a3b8;
  font-weight: 500;
}

.status-item .value {
  color: #e5e7eb;
  font-weight: 600;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* width helpers */
.w-120 {
  min-width: 120px;
}
.w-140 {
  min-width: 140px;
}
.w-160 {
  min-width: 160px;
}

/* Dots */
.status-item .dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #9ca3af;
}
.status-item.sync .dot {
  background: #f59e0b;
}
.status-item.sync.synced .dot {
  background: #10b981;
}
.status-item.checking .dot {
  background: #f59e0b;
}
.status-item.offline .dot {
  background: #ef4444;
}

/* User menu */
.navbar-user-title {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.navbar-user-avatar {
  width: auto;
  height: 26px;
}

.navbar-user-name {
  max-width: 180px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.navbar-user-caret {
  display: inline-block;
  line-height: 1;
  margin-left: 4px;
}

/* Dropdown caret override */
#navbar-user .dropdown-toggle::after {
  display: none !important;
}

/* Dropdown styling */
.navbar .dropdown-menu-dark,
.dropdown-menu-dark {
  background-color: #0f172a !important;
  border: 1px solid rgba(148, 163, 184, 0.15);
  border-radius: 8px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
  min-width: 220px;
}

.dropdown-menu-dark .dropdown-item {
  display: flex;
  cursor: pointer;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
  color: var(--nav-fg);
  transition: background 0.15s ease-in-out;
}

.dropdown-menu-dark .dropdown-item:hover {
  background: rgba(148, 163, 184, 0.12);
}

/* Submenu (language) */
.submenu {
  position: relative;
}

.submenu-toggle.dropdown-item {
  padding-right: 1.25rem;
}

.submenu-caret {
  transition: transform 0.15s ease-in-out;
  line-height: 1;
  opacity: 0.9;
}

.submenu.show .submenu-caret {
  transform: rotate(90deg);
}

.submenu .dropdown-menu {
  left: 100% !important;
  top: 0 !important;
  margin-left: 0.25rem;
  min-width: 220px;
}

/* Responsive adjustments (tablet/desktop down) */
@media (max-width: 992px) {
  .cap-navbar .cap-navbar-row {
    grid-template-columns: 1fr auto;
    margin-left: auto;
  }

  .navbar-status-bar {
    min-width: 0;
    max-width: 100%;
    justify-content: flex-start;
    gap: 8px;
    font-size: 0.8rem;
  }

  .Navbar-brand-slot {
    width: clamp(140px, 40vw, 240px);
  }
}

/* Large screens: hide Bootstrap's burger, only sidebar burger is used */
@media (min-width: 992px) {
  .cap-navbar .navbar-toggler {
    display: none !important;
  }
  .cap-navbar .cap-navbar-row {
    display: grid;
  }
}

/* On very small screens hide the heavy status bar entirely
   so the navbar doesn't look cramped or wrap weirdly */
@media (max-width: 576px) {
  .navbar-status-bar {
    display: none;
  }

  .cap-navbar .cap-navbar-row {
    grid-template-columns: 1fr auto;
  }
}

/* Navbar toggler (burger) */
.cap-navbar .navbar-toggler {
  border-radius: 0.9rem;
  padding: 0.25rem 0.6rem;
  border-color: rgba(148, 163, 184, 0.4);
}

/* Make the expanded mobile menu use a solid dark background */
.cap-navbar .navbar-collapse {
  background-color: transparent;
}

@media (max-width: 991.98px) {
  .cap-navbar .navbar-collapse,
  .cap-navbar .navbar-collapse.collapsing,
  .cap-navbar .navbar-collapse.show {
    background-color: var(--nav-bg);
    padding: 0.5rem 1rem 0.75rem;
    margin-top: 0.35rem;
    border-top: 1px solid rgba(148, 163, 184, 0.25);
  }

  .NavBar-top-container .nav-link,
  .NavBar-top-container .dropdown-toggle {
    padding-top: 0.4rem;
    padding-bottom: 0.4rem;
  }
}

/* Optional left sidebar burger (desktop) */
.Navbar-toggle-btn {
  position: fixed;
  top: 1.2rem;
  left: 12px;
  transform: none;
  background: transparent;
  border: none;
  color: #e5e7eb;
  font-size: 1.4rem;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 1100;
  padding: 0;
}

/* Hide sidebar burger on mobile; mobile uses built-in Nav collapse */
@media (max-width: 991px) {
  .Navbar-toggle-btn {
    display: none;
  }
}

/* Shift navbar content so burger sits left of CAP logo in desktop sidebar mode */
.cap-navbar-with-sidebar {
  padding-left: 3rem;
}

.dropdown-toggle::after {
  display: none !important;
}

.nav-link {
  display: flex;
}

/* Language dropdown title + caret */
.navbar-lang-title {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.navbar-lang-label {
  white-space: nowrap;
}

.navbar-lang-caret {
  display: inline-block;
  line-height: 1;
  margin-left: 2px;
  opacity: 0.9;
}

#navbar-lang .dropdown-toggle::after {
  display: none !important;
}

/* ───────────────────────────────
   Compact radial sync indicator
   ─────────────────────────────── */

.cap-sync {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 2px 6px 8px; /* bottom padding = hover buffer */
  border-radius: 10px;
  cursor: help;
}

.cap-sync-label {
  font-size: 0.78rem;
  font-weight: 700;
  letter-spacing: 0.6px;
  color: rgba(229, 231, 235, 0.85);
}

.cap-sync-ring {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 18px;
  height: 18px;
}

.cap-sync-svg {
  transform: rotate(-90deg);
}

.cap-sync-track {
  fill: none;
  stroke: rgba(148, 163, 184, 0.25);
  stroke-width: 2.5;
}

.cap-sync-progress {
  fill: none;
  stroke-width: 2.5;
  stroke-linecap: round;
  opacity: 0.95;
  transition: stroke-dasharray 600ms ease, opacity 200ms ease;
}

.cap-sync-slash {
  fill: none;
  stroke-width: 2.2;
  stroke-linecap: round;
  opacity: 0;
}

.cap-sync-pct {
  font-size: 0.82rem;
  font-weight: 700;
  color: #e5e7eb;
  letter-spacing: 0.2px;
}

/* States */
.cap-sync[data-state="synced"] .cap-sync-progress {
  stroke: #10b981;
}

.cap-sync[data-state="syncing"] .cap-sync-progress {
  stroke: #f59e0b;
}

/* Only animate when syncing */
.cap-sync[data-state="syncing"] .cap-sync-ring {
  animation: cap-sync-breathe 1.8s ease-in-out infinite;
}

@keyframes cap-sync-breathe {
  0% {
    transform: scale(1);
    opacity: 0.95;
  }
  50% {
    transform: scale(1.06);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 0.95;
  }
}

/* Checking: subtle spinner */
.cap-sync[data-state="checking"] .cap-sync-progress {
  stroke: rgba(229, 231, 235, 0.65);
  stroke-dasharray: 10 999;
}

.cap-sync[data-state="checking"] .cap-sync-svg {
  animation: cap-sync-spin 1.1s linear infinite;
}

@keyframes cap-sync-spin {
  from {
    transform: rotate(-90deg);
  }
  to {
    transform: rotate(270deg);
  }
}

/* Offline: gray + slash */
.cap-sync[data-state="offline"] {
  opacity: 0.75;
}

.cap-sync[data-state="offline"] .cap-sync-progress {
  stroke: rgba(148, 163, 184, 0.35);
  stroke-dasharray: 0 999;
}

.cap-sync[data-state="offline"] .cap-sync-slash {
  stroke: rgba(239, 68, 68, 0.85);
  opacity: 1;
}

/* Tooltip */
.cap-sync-tooltip {
  will-change: opacity, transform;
  position: absolute;
  top: calc(100% + 10px);
  right: 0;

  min-width: 240px;
  white-space: pre-line;
  padding: 10px 12px;
  border-radius: 10px;

  background: #0f172a;
  border: 1px solid rgba(148, 163, 184, 0.18);
  box-shadow: 0 14px 30px rgba(0, 0, 0, 0.45);

  color: #e5e7eb;
  font-size: 0.78rem;
  line-height: 1.25rem;

  opacity: 0;
  visibility: hidden;
  transform: translateY(-4px);
  pointer-events: none;

  transition: opacity 140ms ease, transform 140ms ease,
    visibility 0s linear 140ms;
  z-index: 2000;
}

.cap-sync:hover .cap-sync-tooltip {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
  transition: opacity 140ms ease, transform 140ms ease, visibility 0s;
}
